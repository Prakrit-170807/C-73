{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport * as React from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ToastAndroid from \"react-native-web/dist/exports/ToastAndroid\";\nimport * as Permissions from 'expo-permissions';\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport firebase from \"firebase\";\nimport database from \"../config\";\n\nvar Trans = function (_React$Component) {\n  _inherits(Trans, _React$Component);\n\n  var _super = _createSuper(Trans);\n\n  function Trans() {\n    var _this;\n\n    _classCallCheck(this, Trans);\n\n    _this = _super.call(this);\n\n    _this.accuirecamper = function _callee(use) {\n      var status;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n            case 2:\n              status = _context.sent;\n\n              _this.setState({\n                cameraPER: status == 'Granted',\n                butstate: use,\n                datascn: false\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.barscn = function _callee2(_ref) {\n      var type, data;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              type = _ref.type, data = _ref.data;\n\n              if (_this.state.butstate == \"BookID\") {\n                _this.setState({\n                  datascn: true,\n                  bookscnd: data,\n                  butstate: 'vac'\n                });\n              } else if (_this.state.butstate == \"StudentID\") {\n                _this.setState({\n                  datascn: true,\n                  studentscnd: data,\n                  butstate: 'vac'\n                });\n              }\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.handletransition = function _callee3() {\n      var transactype, studenteligible;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(_this.existbook());\n\n            case 2:\n              transactype = _context3.sent;\n\n              if (transactype) {\n                _context3.next = 8;\n                break;\n              }\n\n              Alert.alert(\" Book doesn't exists in the library \");\n\n              _this.setState({\n                studentscnd: '',\n                bookscnd: ''\n              });\n\n              _context3.next = 19;\n              break;\n\n            case 8:\n              if (!(transactype === 'issue')) {\n                _context3.next = 15;\n                break;\n              }\n\n              _context3.next = 11;\n              return _regeneratorRuntime.awrap(_this.studentligit());\n\n            case 11:\n              studenteligible = _context3.sent;\n\n              if (studenteligible) {\n                _this.BKissue();\n\n                Alert.alert(' Book Has been successfully Issued ');\n              }\n\n              _context3.next = 19;\n              break;\n\n            case 15:\n              _context3.next = 17;\n              return _regeneratorRuntime.awrap(_this.bookreturnStatus());\n\n            case 17:\n              studenteligible = _context3.sent;\n\n              if (studenteligible) {\n                _this.BKreturn();\n\n                Alert.alert(\" Book can't be successfully Issued \");\n              }\n\n            case 19:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.existsbook = function _callee4() {\n      var bookref, transactype;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(database.collection(\"Books\").where(\"BookID\", \"==\", _this.state.bookscnd).get());\n\n            case 2:\n              bookref = _context4.sent;\n              transactype = '';\n\n              if (bookref.docs.length == 0) {\n                transactype = false;\n              } else {\n                bookref.docs.map(function (doc) {\n                  var doctype = doc.data();\n\n                  if (doctype.AviBook) {\n                    transactype = 'issue';\n                  } else {\n                    transactype = 'return';\n                  }\n                });\n              }\n\n              return _context4.abrupt(\"return\", transactype);\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.studentligit = function _callee5() {\n      var studentref, studenteligible;\n      return _regeneratorRuntime.async(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return _regeneratorRuntime.awrap(database.collection(\"Students\").where(\"StudentID\", \"==\", _this.state.studentscnd).get());\n\n            case 2:\n              studentref = _context5.sent;\n              studenteligible = '';\n\n              if (studentref.docs.length == 0) {\n                studenteligible = false;\n\n                _this.setState({\n                  bookscnd: '',\n                  studentsscnd: ''\n                });\n\n                Alert.alert(\" Wait hold up who is that \");\n              } else {\n                studentref.docs.map(function (doc) {\n                  var student = doc.data();\n\n                  if (student.Issued < 2) {\n                    studenteligible = true;\n                  } else {\n                    studenteligible = false;\n\n                    _this.setState({\n                      bookscnd: '',\n                      studentsscnd: ''\n                    });\n\n                    Alert.alert(\" My guy he already has 2 books \");\n                  }\n                });\n              }\n\n              return _context5.abrupt(\"return\", studenteligible);\n\n            case 6:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.bookreturnStatus = function _callee6() {\n      var transactionref;\n      return _regeneratorRuntime.async(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return _regeneratorRuntime.awrap(database.collection(\"\"));\n\n            case 2:\n              transactionref = _context6.sent;\n\n            case 3:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.BKissue = function _callee7() {\n      return _regeneratorRuntime.async(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              database.collection(\"Transac\").add({\n                \"BookID\": _this.state.bookscnd,\n                \"StudentID\": _this.state.studentscnd,\n                \"Date\": firebase.firestore.Timestamp.now().toDate(),\n                \"transactionType\": \"Issue\"\n              });\n              database.collection(\"Books\").doc(_this.state.bookscnd).update({\n                \"AviBook\": false\n              });\n              database.collection(\"Students\").doc(_this.state.studentscnd).update({\n                \"Issued\": firebase.firestore.FieldValue.increment(+1)\n              });\n              ToastAndroid.show('The book had been issued by the student', ToastAndroid.SHORT);\n\n            case 4:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.BKreturn = function _callee8() {\n      return _regeneratorRuntime.async(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              database.collection(\"Transac\").add({\n                \"BookID\": _this.state.bookscnd,\n                \"StudentID\": _this.state.studentscnd,\n                \"Date\": firebase.firestore.Timestamp.now().toDate(),\n                \"transactionType\": \"Return\"\n              });\n              database.collection(\"Books\").doc(_this.state.bookscnd).update({\n                \"AviBook\": true\n              });\n              database.collection(\"Students\").doc(_this.state.studentscnd).update({\n                \"Issued\": firebase.firestore.FieldValue.increment(-1)\n              });\n              ToastAndroid.show('The book had been returned by the student', ToastAndroid.SHORT);\n\n            case 4:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      cameraPER: null,\n      datascn: false,\n      bookscnd: '',\n      studentscnd: '',\n      butstate: 'vac'\n    };\n    return _this;\n  }\n\n  _createClass(Trans, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.butstate != \"vac\" && this.state.cameraPER) {\n        return React.createElement(BarCodeScanner, {\n          onBarCodeScanned: datascn ? 'Done' : this.barscn\n        });\n      } else if (this.state.butstate == 'vac') {\n        return React.createElement(KeyboardAvoidingView, {\n          style: {\n            alignContent: \"center\"\n          },\n          behavior: \"padding\"\n        }, React.createElement(View, null, React.createElement(Image, {\n          style: {\n            height: 300,\n            width: 300\n          },\n          source: require(\"../logo.png\")\n        })), React.createElement(View, null, React.createElement(TextInput, {\n          style: {\n            width: 200,\n            height: 40,\n            borderWidth: 1.5,\n            fontSize: 20\n          },\n          placeholder: \"Book ID\",\n          value: this.state.bookscnd,\n          onChangeText: function onChangeText(Book1) {\n            return _this2.setState({\n              bookscnd: Book1\n            });\n          }\n        }), React.createElement(TouchableOpacity, {\n          style: styles.button,\n          onPress: function onPress() {\n            _this2.accuirecamper(\"BookID\");\n          }\n        }, React.createElement(Text, null, \"enter\"))), React.createElement(View, null, React.createElement(TextInput, {\n          style: {\n            width: 200,\n            height: 40,\n            borderWidth: 1.5,\n            fontSize: 20\n          },\n          placeholder: \"Book ID\",\n          value: this.state.studentscnd,\n          onChangeText: function onChangeText(student1) {\n            return _this2.setState({\n              studentscnd: student1\n            });\n          }\n        }), React.createElement(TouchableOpacity, {\n          style: styles.button,\n          onPress: function onPress() {\n            _this2.accuirecamper(\"StudentID\");\n          }\n        }, React.createElement(Text, null, \"enter\"))), React.createElement(TouchableOpacity, {\n          onPress: function onPress() {\n            _this2.handletransition();\n          }\n        }, React.createElement(Text, null, \"GO\")));\n      }\n    }\n  }]);\n\n  return Trans;\n}(React.Component);\n\nexport { Trans as default };\nvar styles = StyleSheet.create({\n  button: {\n    backgroundColor: '#66BB6A',\n    width: 50,\n    borderWidth: 1.5,\n    borderLeftWidth: 0\n  }\n});","map":{"version":3,"sources":["/Volumes/Coding/NPM/Class Projects/C-73-/components/transaction.js"],"names":["React","Permissions","BarCodeScanner","firebase","database","Trans","accuirecamper","use","askAsync","CAMERA","status","setState","cameraPER","butstate","datascn","barscn","type","data","state","bookscnd","studentscnd","handletransition","existbook","transactype","Alert","alert","studentligit","studenteligible","BKissue","bookreturnStatus","BKreturn","existsbook","collection","where","get","bookref","docs","length","map","doc","doctype","AviBook","studentref","studentsscnd","student","Issued","transactionref","add","firestore","Timestamp","now","toDate","update","FieldValue","increment","ToastAndroid","show","SHORT","alignContent","height","width","require","borderWidth","fontSize","Book1","styles","button","student1","Component","StyleSheet","create","backgroundColor","borderLeftWidth"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  Button,\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Text,\n  Alert,\n  Image,\n  TextInput,\n  KeyboardAvoidingView,\n  ToastAndroid\n\n} from 'react-native';\n\nimport * as Permissions from 'expo-permissions';\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport firebase from \"firebase\"\n\nimport database from \"../config\"\n\nexport default class Trans extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      cameraPER: null,\n      datascn: false,\n      bookscnd: '',\n      studentscnd: '',\n      butstate: 'vac',\n    };\n  }\n\n  accuirecamper = async (use) => {\n    const status = await Permissions.askAsync(Permissions.CAMERA);\n    this.setState({\n      cameraPER: status == 'Granted',\n      butstate: use,\n      datascn: false,\n    });\n  };\n\n  barscn = async ({ type, data }) => {\n    if (this.state.butstate == \"BookID\") {\n      this.setState({\n        datascn: true,\n        bookscnd: data,\n        butstate: 'vac',\n      });\n    }\n    else if (this.state.butstate == \"StudentID\") {\n      this.setState({\n        datascn: true,\n        studentscnd: data,\n        butstate: 'vac',\n      });\n    }\n  };\n\n  handletransition = async () => {\n    var transactype = await this.existbook()\n    if (!transactype) {\n      Alert.alert(\" Book doesn't exists in the library \" )\n      this.setState({studentscnd: '', bookscnd: ''})\n    }\n    else if (transactype === 'issue') {\n      var studenteligible = await this.studentligit()\n      if (studenteligible){\n        this.BKissue()\n        Alert.alert(' Book Has been successfully Issued ')\n      }\n      \n    }\n    else {\n      studenteligible = await this.bookreturnStatus()\n      if (studenteligible){\n        this.BKreturn()\n        Alert.alert(\" Book can't be successfully Issued \")\n      }\n    }\n\n  }\n\n  existsbook = async () => { \n    const bookref = await database.collection(\"Books\").where(\"BookID\", \"==\" , this.state.bookscnd).get();\n    var transactype = ''\n    if (bookref.docs.length == 0) {\n      transactype = false;\n    }\n    else {\n      bookref.docs.map(doc => {\n        var doctype = doc.data()\n        if (doctype.AviBook ) {\n          transactype = 'issue'\n        }\n        else {\n          transactype = 'return'\n        }\n      })\n    }\n    return transactype\n  }\n\n  studentligit = async () =>{ \n    const studentref = await database.collection(\"Students\").where(\"StudentID\", \"==\", this.state.studentscnd).get();\n    var studenteligible = ''\n    if (studentref.docs.length == 0) {\n      studenteligible = false;\n      this.setState ({bookscnd: '' , studentsscnd: ''})\n      Alert.alert(\" Wait hold up who is that \")\n    }\n    else{\n      studentref.docs.map(doc => { \n        var student = doc.data ()\n        if (student.Issued < 2 ) {\n          studenteligible = true\n        }\n        else {\n          studenteligible = false\n          this.setState ({bookscnd: '' , studentsscnd: ''})\n          Alert.alert(\" My guy he already has 2 books \")\n        }\n      })\n    }\n    return studenteligible\n  }\n  \n  bookreturnStatus = async () => {\n    const transactionref = await database.collection(\"\")\n  }\n\n  BKissue = async () => {\n    database.collection(\"Transac\").add({\n      \"BookID\": this.state.bookscnd,\n      \"StudentID\": this.state.studentscnd,\n      \"Date\" : firebase.firestore.Timestamp.now().toDate(),\n      \"transactionType\" : \"Issue\"\n    })\n    database.collection(\"Books\").doc(this.state.bookscnd).update({\n      \"AviBook\": false, \n      \n    })\n    database.collection(\"Students\").doc(this.state.studentscnd).update({\n      \"Issued\" : firebase.firestore.FieldValue.increment(+1)\n    })\n    ToastAndroid.show ('The book had been issued by the student', ToastAndroid.SHORT)\n  }\n\n  BKreturn = async () => {\n    database.collection(\"Transac\").add({\n      \"BookID\": this.state.bookscnd,\n      \"StudentID\": this.state.studentscnd,\n      \"Date\" : firebase.firestore.Timestamp.now().toDate(),\n      \"transactionType\" : \"Return\"\n    })\n    database.collection(\"Books\").doc(this.state.bookscnd).update({\n      \"AviBook\": true, \n      \n    })\n    database.collection(\"Students\").doc(this.state.studentscnd).update({\n      \"Issued\" : firebase.firestore.FieldValue.increment(-1)\n    })\n    ToastAndroid.show ('The book had been returned by the student', ToastAndroid.SHORT)\n  }\n\n  render() {\n    if (this.state.butstate != \"vac\" && this.state.cameraPER) {\n      return (\n        <BarCodeScanner\n          onBarCodeScanned={datascn ? 'Done' : this.barscn}></BarCodeScanner>\n      );\n    } else if (this.state.butstate == 'vac') {\n      return (\n        <KeyboardAvoidingView style={{ alignContent: \"center\" }} behavior=\"padding\" >\n          <View>\n            <Image\n              style={{ height: 300, width: 300 }}\n              source={require('../logo.png')}></Image>\n          </View>\n          <View>\n            <TextInput\n              style={{ width: 200, height: 40, borderWidth: 1.5, fontSize: 20 }}\n              placeholder=\"Book ID\" value={this.state.bookscnd} onChangeText= {Book1 => this.setState({bookscnd:Book1})}>\n            </TextInput>\n            <TouchableOpacity style={styles.button}\n              onPress={() => { this.accuirecamper(\"BookID\") }}>\n              <Text>enter</Text>\n            </TouchableOpacity>\n          </View><View>\n            <TextInput\n              style={{ width: 200, height: 40, borderWidth: 1.5, fontSize: 20 }}\n              placeholder=\"Book ID\" value={this.state.studentscnd} onChangeText= {student1 => this.setState({studentscnd:student1})}>\n            </TextInput>\n            <TouchableOpacity\n              style={styles.button}\n              onPress={() => { this.accuirecamper(\"StudentID\") }}>\n              <Text>enter</Text>\n            </TouchableOpacity>\n          </View>\n          <TouchableOpacity onPress={() => { this.handletransition() }}>\n            <Text>GO</Text>\n          </TouchableOpacity>\n        </KeyboardAvoidingView>\n      );\n    }\n  }\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    backgroundColor: '#66BB6A', width: 50, borderWidth: 1.5, borderLeftWidth: 0\n  },\n});\n"]},"metadata":{},"sourceType":"module"}