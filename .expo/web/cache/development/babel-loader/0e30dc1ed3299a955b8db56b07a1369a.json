{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Volumes/Coding/NPM/Class Projects/C-73-/components/transaction.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport * as React from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport ToastAndroid from \"react-native-web/dist/exports/ToastAndroid\";\nimport * as Permissions from 'expo-permissions';\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport firebase from \"firebase\";\nimport database from \"../config\";\n\nvar Trans = function (_React$Component) {\n  _inherits(Trans, _React$Component);\n\n  var _super = _createSuper(Trans);\n\n  function Trans() {\n    var _this;\n\n    _classCallCheck(this, Trans);\n\n    _this = _super.call(this);\n\n    _this.accuirecamper = function _callee(use) {\n      var status;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n            case 2:\n              status = _context.sent;\n\n              _this.setState({\n                cameraPER: status == 'Granted',\n                butstate: use,\n                datascn: false\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.barscn = function _callee2(_ref) {\n      var type, data;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              type = _ref.type, data = _ref.data;\n\n              if (_this.state.butstate == \"BookID\") {\n                _this.setState({\n                  datascn: true,\n                  bookscnd: data,\n                  butstate: 'vac'\n                });\n              } else if (_this.state.butstate == \"StudentID\") {\n                _this.setState({\n                  datascn: true,\n                  studentscnd: data,\n                  butstate: 'vac'\n                });\n              }\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.handletransition = function _callee3() {\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              database.collection(\"Books\").doc(_this.state.bookscnd).get().then(function (doc) {\n                var DetailBK = doc.data();\n\n                if (DetailBK.AviBook) {\n                  _this.BKissue();\n                } else {\n                  _this.BKreturn();\n                }\n              });\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.BKissue = function _callee4() {\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              database.collection(\"Transac\").add({\n                \"BookID\": _this.state.bookscnd,\n                \"StudentID\": _this.state.studentscnd,\n                \"Date\": firebase.firestore.Timestamp.now().toDate(),\n                \"transactionType\": \"Issue\"\n              });\n              database.collection(\"Books\").doc(_this.state.bookscnd).update({\n                \"AviBook\": false\n              });\n              database.collection(\"Students\").doc(_this.state.studentscnd).update({\n                \"Issued\": firebase.firestore.FieldValue.increment(+1)\n              });\n              ToastAndroid.show('The book had been issued by the student', ToastAndroid.SHORT);\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.BKreturn = function _callee5() {\n      return _regeneratorRuntime.async(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              database.collection(\"Transac\").add({\n                \"BookID\": _this.state.bookscnd,\n                \"StudentID\": _this.state.studentscnd,\n                \"Date\": firebase.firestore.Timestamp.now().toDate(),\n                \"transactionType\": \"Return\"\n              });\n              database.collection(\"Books\").doc(_this.state.bookscnd).update({\n                \"AviBook\": true\n              });\n              database.collection(\"Students\").doc(_this.state.studentscnd).update({\n                \"Issued\": firebase.firestore.FieldValue.increment(-1)\n              });\n              ToastAndroid.show('The book had been returned by the student', ToastAndroid.SHORT);\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      cameraPER: null,\n      datascn: false,\n      bookscnd: '',\n      studentscnd: '',\n      butstate: 'vac'\n    };\n    return _this;\n  }\n\n  _createClass(Trans, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.butstate != \"vac\" && this.state.cameraPER) {\n        return React.createElement(BarCodeScanner, {\n          onBarCodeScanned: datascn ? 'Done' : this.barscn,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 9\n          }\n        });\n      } else if (this.state.butstate == 'vac') {\n        return React.createElement(KeyboardAvoidingView, {\n          style: {\n            alignContent: \"center\"\n          },\n          behavior: \"padding\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 9\n          }\n        }, React.createElement(View, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 11\n          }\n        }, React.createElement(Image, {\n          style: {\n            height: 300,\n            width: 300\n          },\n          source: require(\"../logo.png\"),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }\n        })), React.createElement(View, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 11\n          }\n        }, React.createElement(TextInput, {\n          style: {\n            width: 200,\n            height: 40,\n            borderWidth: 1.5,\n            fontSize: 20\n          },\n          placeholder: \"Book ID\",\n          value: this.state.bookscnd,\n          onChangeText: function onChangeText(Book1) {\n            return _this2.setState({\n              bookscnd: Book1\n            });\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }\n        }), React.createElement(TouchableOpacity, {\n          style: styles.button,\n          onPress: function onPress() {\n            _this2.accuirecamper(\"BookID\");\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }\n        }, React.createElement(Text, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 15\n          }\n        }, \"enter\"))), React.createElement(View, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 18\n          }\n        }, React.createElement(TextInput, {\n          style: {\n            width: 200,\n            height: 40,\n            borderWidth: 1.5,\n            fontSize: 20\n          },\n          placeholder: \"Book ID\",\n          value: this.state.studentscnd,\n          onChangeText: function onChangeText(student1) {\n            return _this2.setState({\n              studentscnd: student1\n            });\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }\n        }), React.createElement(TouchableOpacity, {\n          style: styles.button,\n          onPress: function onPress() {\n            _this2.accuirecamper(\"StudentID\");\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }\n        }, React.createElement(Text, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 15\n          }\n        }, \"enter\"))), React.createElement(TouchableOpacity, {\n          onPress: function onPress() {\n            _this2.handletransition();\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 11\n          }\n        }, React.createElement(Text, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }\n        }, \"GO\")));\n      }\n    }\n  }]);\n\n  return Trans;\n}(React.Component);\n\nexport { Trans as default };\nvar styles = StyleSheet.create({\n  button: {\n    backgroundColor: '#66BB6A',\n    width: 50,\n    borderWidth: 1.5,\n    borderLeftWidth: 0\n  }\n});","map":{"version":3,"sources":["/Volumes/Coding/NPM/Class Projects/C-73-/components/transaction.js"],"names":["React","Permissions","BarCodeScanner","firebase","database","Trans","accuirecamper","use","askAsync","CAMERA","status","setState","cameraPER","butstate","datascn","barscn","type","data","state","bookscnd","studentscnd","handletransition","collection","doc","get","then","DetailBK","AviBook","BKissue","BKreturn","add","firestore","Timestamp","now","toDate","update","FieldValue","increment","ToastAndroid","show","SHORT","alignContent","height","width","require","borderWidth","fontSize","Book1","styles","button","student1","Component","StyleSheet","create","backgroundColor","borderLeftWidth"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  Button,\n  View,\n  StyleSheet,\n  TouchableOpacity,\n  Text,\n  Alert,\n  Image,\n  TextInput,\n  KeyboardAvoidingView,\n  ToastAndroid\n\n} from 'react-native';\n\nimport * as Permissions from 'expo-permissions';\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport firebase from \"firebase\"\n\nimport database from \"../config\"\n\nexport default class Trans extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      cameraPER: null,\n      datascn: false,\n      bookscnd: '',\n      studentscnd: '',\n      butstate: 'vac',\n    };\n  }\n\n  accuirecamper = async (use) => {\n    const status = await Permissions.askAsync(Permissions.CAMERA);\n    this.setState({\n      cameraPER: status == 'Granted',\n      butstate: use,\n      datascn: false,\n    });\n  };\n\n  barscn = async ({ type, data }) => {\n    if (this.state.butstate == \"BookID\") {\n      this.setState({\n        datascn: true,\n        bookscnd: data,\n        butstate: 'vac',\n      });\n    }\n    else if (this.state.butstate == \"StudentID\") {\n      this.setState({\n        datascn: true,\n        studentscnd: data,\n        butstate: 'vac',\n      });\n    }\n  };\n\n  handletransition = async () => {\n    database.collection(\"Books\").doc(this.state.bookscnd).get()\n      .then(doc => {\n        var DetailBK = doc.data()\n        if(DetailBK.AviBook){\n          this.BKissue()\n        }\n        else{\n          this.BKreturn()\n        }\n      })\n  }\n\n  BKissue = async () => {\n    database.collection(\"Transac\").add({\n      \"BookID\": this.state.bookscnd,\n      \"StudentID\": this.state.studentscnd,\n      \"Date\" : firebase.firestore.Timestamp.now().toDate(),\n      \"transactionType\" : \"Issue\"\n    })\n    database.collection(\"Books\").doc(this.state.bookscnd).update({\n      \"AviBook\": false, \n      \n    })\n    database.collection(\"Students\").doc(this.state.studentscnd).update({\n      \"Issued\" : firebase.firestore.FieldValue.increment(+1)\n    })\n    ToastAndroid.show ('The book had been issued by the student', ToastAndroid.SHORT)\n  }\n\n  BKreturn = async () => {\n    database.collection(\"Transac\").add({\n      \"BookID\": this.state.bookscnd,\n      \"StudentID\": this.state.studentscnd,\n      \"Date\" : firebase.firestore.Timestamp.now().toDate(),\n      \"transactionType\" : \"Return\"\n    })\n    database.collection(\"Books\").doc(this.state.bookscnd).update({\n      \"AviBook\": true, \n      \n    })\n    database.collection(\"Students\").doc(this.state.studentscnd).update({\n      \"Issued\" : firebase.firestore.FieldValue.increment(-1)\n    })\n    ToastAndroid.show ('The book had been returned by the student', ToastAndroid.SHORT)\n  }\n\n  render() {\n    if (this.state.butstate != \"vac\" && this.state.cameraPER) {\n      return (\n        <BarCodeScanner\n          onBarCodeScanned={datascn ? 'Done' : this.barscn}></BarCodeScanner>\n      );\n    } else if (this.state.butstate == 'vac') {\n      return (\n        <KeyboardAvoidingView style={{ alignContent: \"center\" }} behavior=\"padding\" >\n          <View>\n            <Image\n              style={{ height: 300, width: 300 }}\n              source={require('../logo.png')}></Image>\n          </View>\n          <View>\n            <TextInput\n              style={{ width: 200, height: 40, borderWidth: 1.5, fontSize: 20 }}\n              placeholder=\"Book ID\" value={this.state.bookscnd} onChangeText= {Book1 => this.setState({bookscnd:Book1})}>\n            </TextInput>\n            <TouchableOpacity style={styles.button}\n              onPress={() => { this.accuirecamper(\"BookID\") }}>\n              <Text>enter</Text>\n            </TouchableOpacity>\n          </View><View>\n            <TextInput\n              style={{ width: 200, height: 40, borderWidth: 1.5, fontSize: 20 }}\n              placeholder=\"Book ID\" value={this.state.studentscnd} onChangeText= {student1 => this.setState({studentscnd:student1})}>\n            </TextInput>\n            <TouchableOpacity\n              style={styles.button}\n              onPress={() => { this.accuirecamper(\"StudentID\") }}>\n              <Text>enter</Text>\n            </TouchableOpacity>\n          </View>\n          <TouchableOpacity onPress={() => { this.handletransition() }}>\n            <Text>GO</Text>\n          </TouchableOpacity>\n        </KeyboardAvoidingView>\n      );\n    }\n  }\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    backgroundColor: '#66BB6A', width: 50, borderWidth: 1.5, borderLeftWidth: 0\n  },\n});\n"]},"metadata":{},"sourceType":"module"}